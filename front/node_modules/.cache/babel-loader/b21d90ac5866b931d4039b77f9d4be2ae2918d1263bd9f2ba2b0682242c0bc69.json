{"ast":null,"code":"var _jsxFileName = \"/Users/mac/Downloads/APP_NS_V1/dev_projet/sauvegardegit/front/src/routes/PrivateRoute.jsx\",\n  _s = $RefreshSig$();\n/**\n * üá¨üáß Private route component compatible with centralized API configuration\n * üá´üá∑ Composant de route priv√©e compatible avec la configuration API centralis√©e\n */\nimport { Outlet, Navigate, useLocation } from \"react-router-dom\";\nimport { useState, useEffect } from \"react\";\nimport useAuth from \"../hooks/useAuth\";\nimport { TOKEN_CONFIG } from \"../config/api.config\";\n\n/**\n * üá¨üáß PrivateRoute - Controls access to protected routes\n * Uses the TOKEN_CONFIG from centralized API configuration\n * \n * üá´üá∑ PrivateRoute - Contr√¥le l'acc√®s aux routes prot√©g√©es\n * Utilise TOKEN_CONFIG de la configuration API centralis√©e\n */\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst PrivateRoute = () => {\n  _s();\n  const auth = useAuth();\n  const location = useLocation();\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const [isLoading, setIsLoading] = useState(true);\n  useEffect(() => {\n    // M√©thode prioritaire: utiliser le hook useAuth\n    const checkAuthViaHook = () => {\n      console.log(\"Auth from hook:\", auth);\n      if (auth && auth.token) {\n        setIsAuthenticated(true);\n        setIsLoading(false);\n        return;\n      }\n\n      // Si le hook ne fournit pas le token, v√©rifier directement localStorage\n      const checkAuthViaLocalStorage = () => {\n        try {\n          // Utiliser la cl√© de stockage de la configuration API centralis√©e\n          const storageKey = (TOKEN_CONFIG === null || TOKEN_CONFIG === void 0 ? void 0 : TOKEN_CONFIG.STORAGE_KEY) || \"auth_token\";\n          const token = localStorage.getItem(storageKey);\n          console.log(\"Token from localStorage using key\", storageKey, \":\", token);\n          setIsAuthenticated(Boolean(token));\n        } catch (error) {\n          console.error(\"Error checking auth:\", error);\n          setIsAuthenticated(false);\n        } finally {\n          setIsLoading(false);\n        }\n      };\n      checkAuthViaLocalStorage();\n    };\n    checkAuthViaHook();\n  }, [auth]);\n\n  // Log de d√©bogage\n  console.log(\"Current path:\", location.pathname);\n  console.log(\"Authentication status:\", isAuthenticated);\n\n  // Afficher un indicateur de chargement pendant la v√©rification\n  if (isLoading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"text-center p-5\",\n      children: \"Chargement...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 12\n    }, this);\n  }\n\n  // Si l'utilisateur n'est pas authentifi√©, rediriger vers la page d'erreur\n  if (!isAuthenticated) {\n    console.log(\"Access denied: Redirecting to /401\");\n    return /*#__PURE__*/_jsxDEV(Navigate, {\n      to: \"/401\",\n      state: {\n        from: location\n      },\n      replace: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 12\n    }, this);\n  }\n\n  // Si l'utilisateur est authentifi√©, afficher le contenu prot√©g√©\n  console.log(\"Access granted: Displaying protected content\");\n  return /*#__PURE__*/_jsxDEV(Outlet, {}, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 75,\n    columnNumber: 10\n  }, this);\n};\n_s(PrivateRoute, \"blCgm1M5TxrvNKZfxGzPnZRWh4I=\", false, function () {\n  return [useAuth, useLocation];\n});\n_c = PrivateRoute;\nexport default PrivateRoute;\nvar _c;\n$RefreshReg$(_c, \"PrivateRoute\");","map":{"version":3,"names":["Outlet","Navigate","useLocation","useState","useEffect","useAuth","TOKEN_CONFIG","jsxDEV","_jsxDEV","PrivateRoute","_s","auth","location","isAuthenticated","setIsAuthenticated","isLoading","setIsLoading","checkAuthViaHook","console","log","token","checkAuthViaLocalStorage","storageKey","STORAGE_KEY","localStorage","getItem","Boolean","error","pathname","className","children","fileName","_jsxFileName","lineNumber","columnNumber","to","state","from","replace","_c","$RefreshReg$"],"sources":["/Users/mac/Downloads/APP_NS_V1/dev_projet/sauvegardegit/front/src/routes/PrivateRoute.jsx"],"sourcesContent":["/**\n * üá¨üáß Private route component compatible with centralized API configuration\n * üá´üá∑ Composant de route priv√©e compatible avec la configuration API centralis√©e\n */\nimport { Outlet, Navigate, useLocation } from \"react-router-dom\";\nimport { useState, useEffect } from \"react\";\nimport useAuth from \"../hooks/useAuth\";\nimport { TOKEN_CONFIG } from \"../config/api.config\";\n\n/**\n * üá¨üáß PrivateRoute - Controls access to protected routes\n * Uses the TOKEN_CONFIG from centralized API configuration\n * \n * üá´üá∑ PrivateRoute - Contr√¥le l'acc√®s aux routes prot√©g√©es\n * Utilise TOKEN_CONFIG de la configuration API centralis√©e\n */\nconst PrivateRoute = () => {\n  const auth = useAuth();\n  const location = useLocation();\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const [isLoading, setIsLoading] = useState(true);\n  \n  useEffect(() => {\n    // M√©thode prioritaire: utiliser le hook useAuth\n    const checkAuthViaHook = () => {\n      console.log(\"Auth from hook:\", auth);\n      \n      if (auth && auth.token) {\n        setIsAuthenticated(true);\n        setIsLoading(false);\n        return;\n      }\n      \n      // Si le hook ne fournit pas le token, v√©rifier directement localStorage\n      const checkAuthViaLocalStorage = () => {\n        try {\n          // Utiliser la cl√© de stockage de la configuration API centralis√©e\n          const storageKey = TOKEN_CONFIG?.STORAGE_KEY || \"auth_token\";\n          const token = localStorage.getItem(storageKey);\n          \n          console.log(\"Token from localStorage using key\", storageKey, \":\", token);\n          \n          setIsAuthenticated(Boolean(token));\n        } catch (error) {\n          console.error(\"Error checking auth:\", error);\n          setIsAuthenticated(false);\n        } finally {\n          setIsLoading(false);\n        }\n      };\n      \n      checkAuthViaLocalStorage();\n    };\n    \n    checkAuthViaHook();\n  }, [auth]);\n  \n  // Log de d√©bogage\n  console.log(\"Current path:\", location.pathname);\n  console.log(\"Authentication status:\", isAuthenticated);\n  \n  // Afficher un indicateur de chargement pendant la v√©rification\n  if (isLoading) {\n    return <div className=\"text-center p-5\">Chargement...</div>;\n  }\n\n  // Si l'utilisateur n'est pas authentifi√©, rediriger vers la page d'erreur\n  if (!isAuthenticated) {\n    console.log(\"Access denied: Redirecting to /401\");\n    return <Navigate to=\"/401\" state={{ from: location }} replace />;\n  }\n\n  // Si l'utilisateur est authentifi√©, afficher le contenu prot√©g√©\n  console.log(\"Access granted: Displaying protected content\");\n  return <Outlet />;\n};\n\nexport default PrivateRoute;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}